<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Notlarım</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
.login,.app{max-width:500px;margin:40px auto;text-align:center}
input,textarea,button{width:100%;padding:12px;margin:6px 0;border:none;border-radius:6px}
button{background:#444;color:#fff;cursor:pointer}
.note{background:#666;padding:10px;margin:8px 0;border-radius:6px;text-align:left}
</style>
</head>
<body>

<div class="login" id="loginBox">
  <h2>Giriş</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Şifre">
  <button onclick="login()">Giriş</button>
</div>

<div class="app" id="appBox" style="display:none;">
  <h2>NOTLARIM</h2>
  <textarea id="noteText" placeholder="Not yaz..."></textarea>
  <button onclick="addNote()">+ Not Ekle</button>
  <div id="notes"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, query, where, onSnapshot }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAPfTIRvh-BEuR2sfdecN3vmiMmzKoH3LM",
  authDomain: "notlarim-62876.firebaseapp.com",
  projectId: "notlarim-62876",
  storageBucket: "notlarim-62876.firebasestorage.app",
  messagingSenderId: "742756530436",
  appId: "1:742756530436:web:390887156b0d6d66b9f851"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = () => {
  signInWithEmailAndPassword(
    auth,
    email.value,
    password.value
  ).catch(e => alert(e.code));
};

onAuthStateChanged(auth, user => {
  if(user){
    loginBox.style.display="none";
    appBox.style.display="block";
    loadNotes(user.uid);
  }
});

function loadNotes(uid){
  const q = query(
    collection(db,"notes"),
    where("uid","==",uid)
  );
  onSnapshot(q, snap=>{
    notes.innerHTML="";
    snap.forEach(d=>{
      const div=document.createElement("div");
      div.className="note";
      div.textContent=d.data().text;
      notes.appendChild(div);
    });
  });
}

window.addNote = async () => {
  if(!noteText.value) return;
  await addDoc(collection(db,"notes"),{
    uid: auth.currentUser.uid,
    text: noteText.value,
    created: Date.now()
  });
  noteText.value="";
};
</script>

</body>
</html>
